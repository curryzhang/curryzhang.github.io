import{_ as r,W as t,X as l,Y as i,Z as e,$ as a,a0 as n,a1 as d,C as o}from"./framework-a4c02b8f.js";const c="/images/redis2023-3-29.jpg",h={},v=e("h2",{id:"主从模式是什么",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#主从模式是什么","aria-hidden":"true"},"#"),a(" 主从模式是什么？")],-1),_=e("p",null,"主机数据更新后根据配置和策略，自动同步到备机的master/slaver机制，Master以写为主，Slave以读为主。",-1),p=e("h2",{id:"作用",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#作用","aria-hidden":"true"},"#"),a(" 作用")],-1),u=e("ol",null,[e("li",null,"读写分离"),e("li",null,"容灾恢复")],-1),m=d(`<h2 id="常用配置" tabindex="-1"><a class="header-anchor" href="#常用配置" aria-hidden="true">#</a> 常用配置</h2><h3 id="一主两仆" tabindex="-1"><a class="header-anchor" href="#一主两仆" aria-hidden="true">#</a> 一主两仆</h3><p>一个Master，两个Slave，Slave只能读不能写；当Slave与Master断开后需要重新slave of连接才可建立之前的主从关系；Master挂掉后，Master关系依然存在，Master重启即可恢复。</p><h3 id="薪火相传" tabindex="-1"><a class="header-anchor" href="#薪火相传" aria-hidden="true">#</a> 薪火相传</h3><p>上一个Slave可以是下一个Slave的Master，Slave同样可以接收其他slaves的连接和同步请求，那么该slave作为了链条中下一个slave的Master，如此可以有效减轻Master的写压力。如果slave中途变更转向，会清除之前的数据，重新建立最新的。</p><h3 id="反客为主" tabindex="-1"><a class="header-anchor" href="#反客为主" aria-hidden="true">#</a> 反客为主</h3><p>当Master挂掉后，Slave可键入命令 slaveof no one使当前redis停止与其他Master redis数据同步，转成Master redis。</p><h2 id="实现步骤" tabindex="-1"><a class="header-anchor" href="#实现步骤" aria-hidden="true">#</a> 实现步骤：</h2><ol><li>服务器设置好主redis</li><li>在第二台服务器上设置redis.conf文件，设置主redis的ip端口和密码</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>slaveof 192.168.0.1 6379

masterauth 123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><p>依次登录主redis和从redis</p></li><li><p>查看信息，我这边配置了两个从库，分别是本地和主redis服务器的6380端口 <img src="`+c+'" alt="" loading="lazy"></p></li><li><p>连接到从库进行设置:<code>set age 15</code></p></li></ol><p><strong>向从库写入数据失败，默认slave-read-only yes，如果为no则可以向从写数据</strong></p><h2 id="容灾处理" tabindex="-1"><a class="header-anchor" href="#容灾处理" aria-hidden="true">#</a> 容灾处理</h2><ol><li>slaveof no one，将一台slave服务器1提升为Master （提升某slave为master）</li><li>slaveof &lt;服务器1ip&gt; 6379（将slave挂至新的master上）</li></ol>',14),f={href:"https://blog.csdn.net/qq_39669058/article/details/87720731",target:"_blank",rel:"noopener noreferrer"};function x(b,g){const s=o("ExternalLinkIcon");return t(),l("div",null,[v,_,p,u,i(" more "),m,e("p",null,[a("参考："),e("a",f,[a("https://blog.csdn.net/qq_39669058/article/details/87720731"),n(s)])])])}const S=r(h,[["render",x],["__file","主从Master-Slave.html.vue"]]);export{S as default};
